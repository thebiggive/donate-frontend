<main>

  <biggive-totalizer
    *ngIf="tickerItems.length > 0"
    primary-colour="primary"
    primary-text-colour="white"
    secondary-colour="secondary"
    secondary-text-colour="black"
    include-gift-aid="true"
    [mainMessage]="tickerMainMessage"
    [tickerItems]="tickerItems">
  </biggive-totalizer>

  <biggive-hero-image
    [mainTitle]="campaign.title"
    [mainImage]="campaign.bannerUri | optimisedImage:2000 | async"
    [teaser]="campaign.summary"
    colour-scheme="primary"
    teaser="We run match funding campaigns to make an extraordinary difference to the worldâ€™s big challenges."
    button-url="/explore"
    button-label="Donate now"
    button-colour-scheme="primary"
    main-image-align-horizontal="right"
  ></biggive-hero-image>

  <app-campaign-search-form
    *ngIf="campaign.campaignCount && campaign.campaignCount > 10"
    [getDefaultSort]="getDefaultSort"
  ></app-campaign-search-form>

  <biggive-page-section class="b-container">
    <app-filters
      *ngIf="campaign.campaignCount && campaign.campaignCount > 1"
      [getDefaultSort]="getDefaultSort"
    ></app-filters>

    <biggive-grid
      *ngIf="children"
      column-count="3"
      infiniteScroll
      [infiniteScrollThrottle]="500"
      (scrolled)="onScroll()"
      [scrollWindow]="true"
    >
      <div *ngFor="let campaign of children">
        <biggive-campaign-card
          id="campaign-{{campaign.id}}"
          [banner]="campaign.imageUri | optimisedImage:830 | async"
          [campaignType]="campaign.isMatched ? 'Match Funded' : 'Unmatched'"
          [campaignTitle]="campaign.title"
          [donateButtonUrl]="'/donate/' + campaign.id"
          [moreInfoButtonUrl]="'/campaign/' + campaign.id"
          [organisationName]="campaign.charity.name"
          primary-figure-label="Match Funds Remaining"
          [primaryFigureAmount]="campaign.matchFundsRemaining | currency: campaign.currencyCode : 'symbol' : '1.0-0'"
          [progressBarCounter]="getPercentageRaised(campaign)"
          secondary-figure-label="Total Funds Raised"
          [secondaryFigureAmount]="campaign.amountRaised | currency: campaign.currencyCode : 'symbol' : '1.0-0'">
        </biggive-campaign-card>
      </div>
    </biggive-grid>

    <div *ngIf="!hasMore" class="t-align-center padding-top-s" >
      <strong>No more campaigns available</strong>
    </div>

    <mat-spinner *ngIf="loading" color="primary" diameter="30" aria-label="Loading campaigns"></mat-spinner>

    <div *ngIf="filterError" tabindex="0">
      <p class="error" aria-live="assertive">
        Could not load the campaign. You might have followed a broken link or lost connectivity.<br />
        Not to worry, you can
        <a routerLink="/">browse all active campaigns here</a>!
      </p>
    </div>
  </biggive-page-section>
</main>
